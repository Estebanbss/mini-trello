import{A as c,Ia as h,Ja as u,c as i,f as n,j as a,ua as m,w as l}from"./chunk-7A3Z4Z4W.js";var j=(()=>{let o=class o{constructor(e,t){this.http=e,this.cookies=t,this.apiLogin=this.getBaseUrl()+"/login/authenticate"}login(e){return this.http.post(this.apiLogin,e).pipe(a(t=>(console.error(t.error.message),alert(t.error.message),n("e"))))}register(e){return this.http.post(this.getBaseUrl()+"/account/create",e).pipe(a(t=>(console.error(t.error.message),alert(t.error.message),n("e"))))}getBaseUrl(){return h.production?"https://www.trelloclone.somee.com/api":"/api"}logout(){return i(this,null,function*(){this.cookies.deleteAll()})}getToken(){return i(this,null,function*(){return yield this.cookies.get("token")})}isAuth(){return i(this,null,function*(){try{let e=yield this.getToken();return e?!(yield this.isTokenExpired(e))?.expired:!1}catch(e){return console.error("Error al verificar la autenticaci\xF3n:",e),!1}})}isTokenExpired(e){return i(this,null,function*(){let t=e.split(".");return new Promise((g,k)=>{try{let r=JSON.parse(atob(t[1]));this.cookies.set("user.email",r["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"]),this.cookies.set("user.name",r["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"]),this.cookies.set("user.type",r.AType);let p=Math.floor(new Date().getTime()/1e3),d=r?.exp-p;g({expired:p>=r?.exp,timeRemaining:d})}catch(r){console.error("Error parsing token payload:",r),k(r)}})})}};o.\u0275fac=function(t){return new(t||o)(c(m),c(u))},o.\u0275prov=l({token:o,factory:o.\u0275fac,providedIn:"root"});let s=o;return s})();export{j as a};
