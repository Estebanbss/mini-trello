import{A as n,Ia as h,Ja as u,c as i,f as c,j as p,ua as l,w as m}from"./chunk-TGWPPAMH.js";var j=(()=>{let o=class o{constructor(e,t){this.http=e,this.cookies=t,this.apiLogin=this.getBaseUrl()+"/login/authenticate"}login(e){return this.http.post(this.apiLogin,e).pipe(p(t=>(console.error(t.error.message),alert(t.error.message),c("e"))))}getBaseUrl(){return h.production?"http://www.trelloclone.somee.com/":"/api"}getToken(){return i(this,null,function*(){return yield this.cookies.get("token")})}isAuth(){return i(this,null,function*(){try{let e=yield this.getToken();return e?!(yield this.isTokenExpired(e))?.expired:!1}catch(e){return console.error("Error al verificar la autenticaci\xF3n:",e),!1}})}isTokenExpired(e){return i(this,null,function*(){let t=e.split(".");return new Promise((k,d)=>{try{let r=JSON.parse(atob(t[1]));this.cookies.set("user.email",r["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"]),this.cookies.set("user.name",r["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"]),this.cookies.set("user.type",r.AType);let a=Math.floor(new Date().getTime()/1e3),f=r?.exp-a;k({expired:a>=r?.exp,timeRemaining:f})}catch(r){console.error("Error parsing token payload:",r),d(r)}})})}};o.\u0275fac=function(t){return new(t||o)(n(l),n(u))},o.\u0275prov=m({token:o,factory:o.\u0275fac,providedIn:"root"});let s=o;return s})();export{j as a};
